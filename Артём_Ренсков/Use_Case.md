## Use Case: AI-агент для генерации постов на основе истории Telegram-канала

### 1. Название
Автоматическая генерация постов на основе истории канала Telegram с помощью AI-агента

### 2. Идентификатор
UC-CONTENT-BOT-002

### 3. Главный актор
Автор блога (владелец Telegram-канала)

#### Вспомогательные акторы
- Telegram-бот (AI-агент)
- Telegram API (Bot API + Channel Post)
- Хранилище данных (база истории постов)

### 4. Предусловия
- Telegram-бот добавлен в канал в качестве администратора с правами читать сообщения.
- У канала есть хотя бы 3 поста для начального анализа.
- Бот настроен на приём обновлений типа `channel_post`.
- AI-модуль готов к анализу текста и генерации контента.

### 5. Ограничения
- Бот получает только посты, опубликованные **после** его добавления.
- Для получения старых постов требуется ручной импорт или Telegram API через MTProto.
- Объём анализа может быть ограничен по количеству сообщений (например, последние 50 постов).
- Сложность генерации ограничена ресурсами хостинга и лимитами LLM API (например, OpenAI, Claude и т.д.).

### 6. Триггер
Пользователь:
- добавляет бота в Telegram-канал, **или**
- отправляет команду `/newpost` в чат с ботом.

### 7. Основной сценарий
1. Пользователь добавляет бота в канал как администратора.
2. Бот отслеживает новые посты (`channel_post`) и сохраняет их в базу.
3. Пользователь отправляет команду `/newpost`.
4. Бот анализирует сохранённую историю публикаций (темы, стиль, структура).
5. Бот предлагает 2–3 идеи для нового поста.
6. Пользователь выбирает идею.
7. Бот предлагает структуру поста.
8. Пользователь подтверждает.
9. Бот генерирует черновик поста.
10. Пользователь получает итоговый текст.

### 8 Альтернативный сценарий
- 2.1: Пользователь хочет загрузить старые посты вручную.
- 8.2: Пользователь не выбирает идею и вводит собственную тему.
- 8.3: Пользователь отправляет команду `/style` для смены стилистики.

### 8.2 Альтернативный сценарий
2.1. Пользователь добавляет бота в канал как администратора.
2.2. Пользователь понимает, что бот не видит старые посты.
2.3. Бот предлагает пользователю несколько вариантов загрузки истории:
    - вручную скопировать и вставить тексты постов;
    - загрузить `.txt` или `.csv` файл со всеми постами;
    - отправить экспорт Telegram-канала из `my.telegram.org`.
2.4. Пользователь выбирает способ загрузки:
    - Вариант А: Вручную вставляет 5–10 текстов постов в чат с ботом (по одному или списком).
    - Вариант B: Загружает файл с историей постов.
2.5. Бот сохраняет каждый пост в базу данных и подтверждает успешную загрузку.
2.6. После загрузки не менее 3 постов бот сообщает: "Готов предложить новые идеи на основе истории. Напишите `/newpost` или дождитесь следующего триггера."
2.7. Пользователь отправляет команду `/newpost`.
2.8. Бот анализирует сохранённую историю публикаций (темы, стиль, структура).
2.9. Бот предлагает 2–3 идеи для нового поста.
2.10. Пользователь выбирает идею.
2.11. Бот предлагает структуру поста.
2.12. Пользователь подтверждает.
2.13. Бот генерирует черновик поста.
2.14. Пользователь получает итоговый текст.

### 8.6 Альтернативный сценарий
6.1. Пользователь добавляет бота в канал как администратора.
6.2. Бот отслеживает новые посты (`channel_post`) и сохраняет их в базу.
6.3. Пользователь отправляет команду `/newpost`.
6.4. Бот анализирует сохранённую историю публикаций (темы, стиль, структура).
6.5. Бот предлагает 2–3 идеи для нового поста.
6.6. Пользователь не выбирает идею и вводит собственную тему.
6.7. Бот предлагает структуру поста.
6.8. Пользователь подтверждает.
6.9. Бот генерирует черновик поста.
6.10. Пользователь получает итоговый текст.

### 8.8 Альтернативный сценарий
8.1. Пользователь добавляет бота в канал как администратора.
8.2. Бот отслеживает новые посты (`channel_post`) и сохраняет их в базу.
8.3. Пользователь отправляет команду `/newpost`.
8.4. Бот анализирует сохранённую историю публикаций (темы, стиль, структура).
8.5. Бот предлагает 2–3 идеи для нового поста.
8.6. Пользователь выбирает идею.
8.7. Бот предлагает структуру поста.
8.8. Пользователь отправляет команду `/style` для смены стилистики.
8.9. Бот генерирует черновик поста.
8.10. Пользователь получает итоговый текст.

### 9. Исключительные сценарии
- 2.1: Бот не имеет прав на чтение постов канала → сообщает об ошибке.
- 4.1: Нет истории постов → бот запрашивает примеры вручную.
- 9.1: Ошибка генерации текста (API сбой, лимиты) → бот предлагает повторить.

### 10. Гарантии успеха
- AI-агент сформировал релевантный черновик поста, соответствующий стилю канала.
- Пользователь получил идеи и финальный текст для публикации.
- История постов успешно сохранена и используется для будущих генераций.
- Поддерживается непрерывное улучшение качества контента без ручного труда.
